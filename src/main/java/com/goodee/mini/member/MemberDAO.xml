<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.goodee.mini.member.MemberDAO">
  	<resultMap type="MemberVO" id="loginResult">
  		<id column="mem_no" property="memNo"/>
  		<id column="mem_id" property="memId"/>
  		<result column="mem_pass" property="memPass"/>
  		<result column="mem_name" property="memName"/>
  		<result column="mem_email" property="memEmail"/>
  		<result column="mem_phone" property="memPhone"/>
  		<result column="mem_birth" property="memBirth"/>
  		<result column="mem_address" property="memAddress"/>
  		<result column="enable" property="enable"/>
  		
  		<collection property="roleVOs" javaType="java.util.List" ofType="RoleVO">
  			<id column="auth_no" property="authNo"/>
  			<result column="auth_name" property="authName"/>
  		</collection>
  	</resultMap>
  	<insert id="join" parameterType="MemberVO">
		INSERT INTO MEMBER
		VALUES (null, 2, #{memId}, #{memPass}, #{memName}, #{memEmail}, #{memPhone}, #{memBirth}, #{memAddress}, 1)
	</insert>
	
	<select id="login" parameterType="MemberVO" resultMap="loginResult">
		SELECT M.*, A.*
		FROM MEMBER M
			INNER JOIN AUTH A
			USING(auth_no)
		WHERE mem_id = #{memId}
	</select>
  </mapper>